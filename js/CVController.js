var __bind=function(t,e){return function(){return t.apply(e,arguments)}},__indexOf=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};define(["cookieController","template_polyfill","l20n"],function(t){var e;return e=function(){function e(){this.deleteLoadingBlock=__bind(this.deleteLoadingBlock,this),this.afterLocalization=__bind(this.afterLocalization,this),this.readyToLocalize=__bind(this.readyToLocalize,this),this.changeLanguage=__bind(this.changeLanguage,this),this.ip2Country=__bind(this.ip2Country,this);var e,n,i,o;for(this.pointer_event="click",this.cookie=t,this.loading=document.querySelector("body>.loading"),document.body.classList.contains("touch")===!0&&(this.pointer_event="touchstart"),e=document.querySelectorAll("nav.language a"),i=0,o=e.length;o>i;i++)n=e[i],n.addEventListener(this.pointer_event,this.changeLanguage);this.lang=this.cookie.getItem("lang"),null===this.lang?(this.timer=window.setTimeout(this.deleteLoadingBlock,1e3),require(["http://www.telize.com/geoip?callback=document.cv.ip2Country"])):document.l10n.once(this.readyToLocalize)}return e.prototype.ip2Country=function(t){var e,n;return e=["AZ","BY","KZ","KG","MD","MN","RU","TJ","TM","UA","UZ"],this.lang="en",n=t.country_code,__indexOf.call(e,n)>=0&&(this.lang="ru"),this.cookie.setItem("lang",this.lang,"Infinity"),document.l10n.once(this.readyToLocalize)},e.prototype.changeLanguage=function(t){var e;return t.preventDefault(),e=t.currentTarget,this.lang=e.getAttribute("lang"),this.cookie.setItem("lang",this.lang,"Infinity"),document.l10n.requestLocales(this.lang)},e.prototype.readyToLocalize=function(){return this.cookie.setItem("lang",this.lang,"Infinity"),document.l10n.addEventListener("ready",this.afterLocalization),document.l10n.requestLocales(this.lang)},e.prototype.afterLocalization=function(){return document.l10n.removeEventListener("ready",this.afterLocalization),this.loading.classList.add("loaded"),window.clearTimeout(this.timer),this.timer=window.setTimeout(this.deleteLoadingBlock,350)},e.prototype.deleteLoadingBlock=function(){return this.loading.parentNode.removeChild(this.loading)},e}()});